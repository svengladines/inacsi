
<!DOCTYPE html>
<html>

<head>
	
	<title>ACSI Groepspraktijk</title>
	
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
	<meta http-equiv="Pragma" content="no-cache"/>
	<meta http-equiv="Expires" content="0"/>

    <!-- Bootstrap core CSS -->
    <link href="resources/bootstrap-3.3.5/css/bootstrap.css" rel="stylesheet">
    <link href="resources/bootstrap-3.3.5/css/bootstrap-theme.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="resources/css/inacsi.css" rel="stylesheet">
    
    <!-- Awesome fonts -->
    <link href="resources/font-awesome-4.5.0/css/font-awesome.css" rel="stylesheet">
    
    <!-- Other fonts -->
    <link href="http://fonts.googleapis.com/css?family=Great+Vibes" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Merienda+One" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>
		
	<script type="text/javascript" src="resources/javascript/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="resources/javascript/lodash-4.5.1.js"></script>
    <script type="text/javascript" src="resources/javascript/moment.js"></script>
    <script type="text/javascript" src="resources/javascript/templates.js"></script>
    <script type="text/javascript" src="resources/bootstrap-3.3.5/js/bootstrap.js"></script>	

</head>

<body>

	<div id="bdy">
	
	</div>
	
	<button id="btn-publish" type="button" class="btn btn-primary btn-fab">Publiceer</button><br/>
		
	<script>
	
	var $jq = jQuery.noConflict();
	
	var addListeners = function ( html ) {
		
		$jq(".article").click( function( event ) {
			
			var id = $jq(this).attr( "data-article-id" );
			
			window.location.href = "edit.html?article=" + id;
			
		});
		
		$jq(".editable").each( function( event ) {
			
			var id = $jq(this).attr( "data-editable-id" );
			
			var url = "http://localhost:8099/api/articles/" + id + "/versions/latest" ;
			
			loadEditable( url, [ renderEditable ] );
			
		});
		
	}
	
	var renderPage = function ( html ) {
		
		$jq("#bdy").html( html );
		
	}
	
	var renderEditable = function( editable ) {
		
		$jq("[data-editable-id='" + editable.id + "']").html( editable.text );
		
	};
	
	var loadEditable = function ( url, callbacks ) {
		
		$jq.ajax( {
			type: "get",
			url: url,
			dataType: "json",
		    processData: true,
			success: function( returned ) {
				if ( callbacks ) {
					for ( var i in callbacks ) {
						var callback = callbacks[ i ];
						callback( returned );	
					}
					
				}
				else {
					// success( button, statusElement, "Opgeslagen" );
				}
			},
			error: function(  jqXHR, textStatus, errorThrown ) {
				console.log( errorThrown );
			}
		});
		
	}
	
	var loadPage = function ( url, callbacks ) {
		
		$jq.ajax( {
			type: "get",
			url: url,
			dataType: "html",
		    processData: false,
			success: function( returned ) {
				if ( callbacks ) {
					for ( var i in callbacks ) {
						var callback = callbacks[ i ];
						callback( returned );	
					}
					
				}
				else {
					// success( button, statusElement, "Opgeslagen" );
				}
			},
			error: function(  jqXHR, textStatus, errorThrown ) {
				console.log( errorThrown );
			}
		});
		
	};
	
	var loadThePage = function ( pageID ) {
		
		var url = "http://localhost:8099/page.html?page=" + pageID ;
		loadPage( url, [ renderPage, addListeners ] );
		
	};
	
		$jq( document ).ready(function() {
			
			var pageID 
				= "index"; 
			
			loadThePage( pageID );
			
		});
		
		
	</script>
</html>
